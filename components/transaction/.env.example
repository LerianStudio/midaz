# TRANSACTION SERVICE ENVIRONMENT
# ENV_NAME: Runtime environment name. Values: development|staging|production.
ENV_NAME=development

# VERSION: Service version string used in logs/telemetry.
VERSION=v3.4.8

# HTTP SERVER
# SERVER_PORT: Port for the HTTP API.
SERVER_PORT=3001
# SERVER_ADDRESS: HTTP bind address. Usually :${SERVER_PORT}.
SERVER_ADDRESS=:${SERVER_PORT}

# GRPC / PROTO
# PROTO_URL: gRPC service hostname advertised to clients.
PROTO_URL=midaz-transaction
# PROTO_PORT: Port for gRPC server.
PROTO_PORT=3011
# PROTO_ADDRESS: gRPC bind address. Usually :${PROTO_PORT}.
PROTO_ADDRESS=:${PROTO_PORT}
# GRPC_REFLECTION_ENABLED: Enable gRPC reflection for tooling. Values: true|false.
GRPC_REFLECTION_ENABLED=false

# AUTH / PLUGINS
# PLUGIN_AUTH_ENABLED: Enable auth plugin integration. Values: true|false.
PLUGIN_AUTH_ENABLED=false
# PLUGIN_AUTH_HOST: Auth plugin host (host:port) when enabled.
PLUGIN_AUTH_HOST=

# CASDOOR (optional SSO)
# CASDOOR_ADDRESS: Casdoor base URL (e.g., https://casdoor.example.com).
CASDOOR_ADDRESS=
# CASDOOR_CLIENT_ID: OAuth client ID.
CASDOOR_CLIENT_ID=
# CASDOOR_CLIENT_SECRET: OAuth client secret.
CASDOOR_CLIENT_SECRET=
# CASDOOR_ORGANIZATION_NAME: Casdoor organization name.
CASDOOR_ORGANIZATION_NAME=
# CASDOOR_APPLICATION_NAME: Casdoor application name.
CASDOOR_APPLICATION_NAME=
# CASDOOR_MODEL_NAME: Casdoor model name.
CASDOOR_MODEL_NAME=
# CASDOOR_JWK_ADDRESS: JWK endpoint for token validation.
CASDOOR_JWK_ADDRESS=

# ACCOUNTING / ROUTING
# TRANSACTION_ROUTE_VALIDATION: Optional list of <organization-id>:<ledger-id> pairs (comma-separated) to enforce routing validation.
TRANSACTION_ROUTE_VALIDATION=
# OPERATION_ROUTE_LOOKUP_MAX_ATTEMPTS: Max attempts to resolve an operation route. Values: integer >=1.
OPERATION_ROUTE_LOOKUP_MAX_ATTEMPTS=5
# OPERATION_ROUTE_LOOKUP_BASE_BACKOFF_MS: Base backoff between route lookup retries in ms.
OPERATION_ROUTE_LOOKUP_BASE_BACKOFF_MS=200

# DATABASE (POSTGRESQL - PRIMARY)
# DB_HOST: Primary Postgres host.
DB_HOST=midaz-postgres-primary
# DB_USER: Primary Postgres user.
DB_USER=midaz
# DB_NAME: Primary Postgres database name.
DB_NAME=transaction
# DB_PASSWORD: Primary Postgres password.
DB_PASSWORD=lerian
# DB_PORT: Primary Postgres port.
DB_PORT=5701
# DB_SSLMODE: Postgres SSL mode. Values: disable|require.
DB_SSLMODE=disable

# DATABASE (POSTGRESQL - REPLICA)
# DB_REPLICA_HOST: Replica Postgres host (read-only).
DB_REPLICA_HOST=midaz-postgres-replica
# DB_REPLICA_USER: Replica Postgres user.
DB_REPLICA_USER=midaz
# DB_REPLICA_NAME: Replica Postgres database name.
DB_REPLICA_NAME=transaction
# DB_REPLICA_PASSWORD: Replica Postgres password.
DB_REPLICA_PASSWORD=lerian
# DB_REPLICA_PORT: Replica Postgres port.
DB_REPLICA_PORT=5702
# DB_REPLICA_SSLMODE: Replica Postgres SSL mode. Values: disable|require.
DB_REPLICA_SSLMODE=disable

# DATABASE POOLING
# DB_MAX_OPEN_CONNS: Max open DB connections.
DB_MAX_OPEN_CONNS=3000
# DB_MAX_IDLE_CONNS: Max idle DB connections.
DB_MAX_IDLE_CONNS=3000

# DATABASE TIMEOUTS
# statement_timeout=5s: Cancel queries running longer than 5 seconds.
# lock_timeout=3s: Fail if waiting for a lock longer than 3 seconds.
# These are configured in bootstrap/config.go (not env vars).

# MONGO (METADATA)
# MONGO_URI: Mongo scheme. Values: mongodb|mongodb+srv.
MONGO_URI=mongodb
# MONGO_HOST: Mongo host.
MONGO_HOST=midaz-mongodb
# MONGO_NAME: Mongo database name.
MONGO_NAME=transaction
# MONGO_USER: Mongo user.
MONGO_USER=midaz
# MONGO_PASSWORD: Mongo password.
MONGO_PASSWORD=lerian
# MONGO_PORT: Mongo port.
MONGO_PORT=5703
# MONGO_MAX_POOL_SIZE: Mongo connection pool size.
MONGO_MAX_POOL_SIZE=1000
# MONGO_PARAMETERS: Optional connection parameters (query string).
MONGO_PARAMETERS=

# REDIS (CACHE/QUEUE)
# REDIS_HOST: Redis host (standalone), or comma-separated endpoints for sentinel/cluster.
REDIS_HOST=midaz-valkey:5704
# REDIS_MASTER_NAME: Sentinel master name (required when using sentinel).
REDIS_MASTER_NAME=
# REDIS_TLS: Enable TLS for Redis. Values: true|false.
REDIS_TLS=false
# REDIS_CA_CERT: Path to CA cert (required when REDIS_TLS=true).
REDIS_CA_CERT=
# REDIS_USE_GCP_IAM: Use GCP IAM auth. Values: true|false.
REDIS_USE_GCP_IAM=false
# REDIS_SERVICE_ACCOUNT: Service account email for GCP IAM auth.
REDIS_SERVICE_ACCOUNT=
# GOOGLE_APPLICATION_CREDENTIALS: Path to GCP credentials JSON.
GOOGLE_APPLICATION_CREDENTIALS=
# REDIS_TOKEN_LIFETIME: IAM token lifetime in minutes (<= 60).
REDIS_TOKEN_LIFETIME=60
# REDIS_TOKEN_REFRESH_DURATION: IAM token refresh interval in minutes.
REDIS_TOKEN_REFRESH_DURATION=45
# REDIS_PASSWORD: Redis password (leave empty for no auth).
REDIS_PASSWORD=lerian
# REDIS_DB: Redis database index.
REDIS_DB=0
# REDIS_PROTOCOL: Redis protocol version (2 or 3).
REDIS_PROTOCOL=3

# REDIS POOL & RETRY
# REDIS_POOL_SIZE: Max connections in pool.
REDIS_POOL_SIZE=50
# REDIS_MIN_IDLE_CONNS: Minimum idle connections.
REDIS_MIN_IDLE_CONNS=0
# REDIS_READ_TIMEOUT: Read timeout in seconds.
REDIS_READ_TIMEOUT=3
# REDIS_WRITE_TIMEOUT: Write timeout in seconds.
REDIS_WRITE_TIMEOUT=3
# REDIS_DIAL_TIMEOUT: Dial timeout in seconds.
REDIS_DIAL_TIMEOUT=5
# REDIS_POOL_TIMEOUT: Pool wait timeout in seconds.
REDIS_POOL_TIMEOUT=2
# REDIS_MAX_RETRIES: Max retry attempts.
REDIS_MAX_RETRIES=3
# REDIS_MIN_RETRY_BACKOFF: Min backoff in milliseconds.
REDIS_MIN_RETRY_BACKOFF=8
# REDIS_MAX_RETRY_BACKOFF: Max backoff in seconds.
REDIS_MAX_RETRY_BACKOFF=1

# LOGGING
# LOG_LEVEL: Log verbosity. Values: debug|info|warn|error.
LOG_LEVEL=debug

# OPEN TELEMETRY
# OTEL_RESOURCE_SERVICE_NAME: Service name in telemetry.
OTEL_RESOURCE_SERVICE_NAME=transaction
# OTEL_LIBRARY_NAME: Instrumentation library name.
OTEL_LIBRARY_NAME=github.com/LerianStudio/midaz/v3/components/transaction
# OTEL_RESOURCE_SERVICE_VERSION: Service version for telemetry.
OTEL_RESOURCE_SERVICE_VERSION=${VERSION}
# OTEL_RESOURCE_DEPLOYMENT_ENVIRONMENT: Environment label for telemetry.
OTEL_RESOURCE_DEPLOYMENT_ENVIRONMENT=${ENV_NAME}
# OTEL_EXPORTER_OTLP_ENDPOINT_PORT: OTLP exporter port.
OTEL_EXPORTER_OTLP_ENDPOINT_PORT=4317
# OTEL_EXPORTER_OTLP_ENDPOINT: OTLP exporter endpoint.
OTEL_EXPORTER_OTLP_ENDPOINT=midaz-otel-lgtm:${OTEL_EXPORTER_OTLP_ENDPOINT_PORT}
# ENABLE_TELEMETRY: Enable OpenTelemetry. Values: true|false.
ENABLE_TELEMETRY=false

# RABBITMQ
# RABBITMQ_URI: RabbitMQ URI scheme (amqp|amqps).
RABBITMQ_URI=amqp
# RABBITMQ_HOST: RabbitMQ host.
RABBITMQ_HOST=midaz-rabbitmq
# RABBITMQ_PORT_HOST: Management/HTTP port (for health checks).
RABBITMQ_PORT_HOST=3003
# RABBITMQ_PORT_AMQP: AMQP port.
RABBITMQ_PORT_AMQP=3004
# RABBITMQ_DEFAULT_USER: Default RabbitMQ user.
RABBITMQ_DEFAULT_USER=transaction
# RABBITMQ_DEFAULT_PASS: Default RabbitMQ password.
RABBITMQ_DEFAULT_PASS=lerian
# RABBITMQ_CONSUMER_USER: Consumer username.
RABBITMQ_CONSUMER_USER=consumer
# RABBITMQ_CONSUMER_PASS: Consumer password.
RABBITMQ_CONSUMER_PASS=lerian
# RABBITMQ_NUMBERS_OF_WORKERS: Number of consumer workers.
RABBITMQ_NUMBERS_OF_WORKERS=5
# RABBITMQ_NUMBERS_OF_PREFETCH: Prefetch count per consumer.
RABBITMQ_NUMBERS_OF_PREFETCH=10
# RABBITMQ_HEALTH_CHECK_URL: RabbitMQ health check URL.
RABBITMQ_HEALTH_CHECK_URL=http://${RABBITMQ_HOST}:${RABBITMQ_PORT_AMQP}
# RABBITMQ_BALANCE_CREATE_QUEUE: Queue for balance creation events.
RABBITMQ_BALANCE_CREATE_QUEUE=transaction.balance_create.queue
# RABBITMQ_TRANSACTION_BALANCE_OPERATION_EXCHANGE: Exchange for balance ops.
RABBITMQ_TRANSACTION_BALANCE_OPERATION_EXCHANGE=transaction.transaction_balance_operation.exchange
# RABBITMQ_TRANSACTION_BALANCE_OPERATION_KEY: Routing key for balance ops.
RABBITMQ_TRANSACTION_BALANCE_OPERATION_KEY=transaction.transaction_balance_operation.key
# RABBITMQ_TRANSACTION_BALANCE_OPERATION_QUEUE: Queue for balance ops.
RABBITMQ_TRANSACTION_BALANCE_OPERATION_QUEUE=transaction.transaction_balance_operation.queue
# RABBITMQ_TRANSACTION_ASYNC: Enable async transaction processing. Values: true|false.
RABBITMQ_TRANSACTION_ASYNC=true

# TRANSACTION EXCHANGE EVENTS
# RABBITMQ_TRANSACTION_EVENTS_ENABLED: Publish transaction events. Values: true|false.
RABBITMQ_TRANSACTION_EVENTS_ENABLED=true
# RABBITMQ_TRANSACTION_EVENTS_EXCHANGE: Exchange for transaction events.
RABBITMQ_TRANSACTION_EVENTS_EXCHANGE=transaction.transaction_events.exchange

# AUDIT LOGGING
# AUDIT_LOG_ENABLED: Enable audit logging. Values: true|false.
AUDIT_LOG_ENABLED=false
# RABBITMQ_AUDIT_EXCHANGE: Exchange for audit logs.
RABBITMQ_AUDIT_EXCHANGE=audit.append_log.exchange
# RABBITMQ_AUDIT_KEY: Routing key for audit logs.
RABBITMQ_AUDIT_KEY=audit.append_log.key
# RABBITMQ_TRANSACTION_AUDIT_EXCHANGE: Exchange for transaction audit logs (when enabled).
RABBITMQ_TRANSACTION_AUDIT_EXCHANGE=audit.append_log.exchange
# RABBITMQ_TRANSACTION_AUDIT_KEY: Routing key for transaction audit logs (when enabled).
RABBITMQ_TRANSACTION_AUDIT_KEY=audit.append_log.key

# SWAGGER / OPENAPI
# SWAGGER_TITLE: API title.
SWAGGER_TITLE="Transaction API"
# SWAGGER_DESCRIPTION: API description.
SWAGGER_DESCRIPTION="Documentation for the Midaz Transaction API"
# SWAGGER_VERSION: API version.
SWAGGER_VERSION=${VERSION}
# SWAGGER_HOST: API host used in docs.
SWAGGER_HOST=${SERVER_ADDRESS}
# SWAGGER_BASE_PATH: Base path for API routes.
SWAGGER_BASE_PATH=/
# SWAGGER_SCHEMES: Allowed schemes (comma-separated). Example: http,https.
SWAGGER_SCHEMES=http
# SWAGGER_LEFT_DELIMITER: Template left delimiter.
SWAGGER_LEFT_DELIMITER={{
# SWAGGER_RIGHT_DELIMITER: Template right delimiter.
SWAGGER_RIGHT_DELIMITER=}}

# PAGINATION
# MAX_PAGINATION_LIMIT: Max items per page.
MAX_PAGINATION_LIMIT=100
# MAX_PAGINATION_MONTH_DATE_RANGE: Max month span for date range queries.
MAX_PAGINATION_MONTH_DATE_RANGE=1

# BALANCE SYNC WORKER
# BALANCE_SYNC_WORKER_ENABLED: Enable balance sync worker. Values: true|false.
BALANCE_SYNC_WORKER_ENABLED=false
# BALANCE_SYNC_MAX_WORKERS: Max workers for balance sync.
BALANCE_SYNC_MAX_WORKERS=5

# METADATA OUTBOX WORKER
# METADATA_OUTBOX_WORKER_ENABLED: Enable metadata outbox worker. Values: true|false.
METADATA_OUTBOX_WORKER_ENABLED=true
# METADATA_OUTBOX_MAX_WORKERS: Max concurrent outbox workers.
METADATA_OUTBOX_MAX_WORKERS=5
# METADATA_OUTBOX_RETENTION_DAYS: Retention (days) for processed outbox entries.
METADATA_OUTBOX_RETENTION_DAYS=7

# DLQ CONSUMER
# DLQ_CONSUMER_ENABLED: Enable DLQ replay consumer. Values: true|false.
DLQ_CONSUMER_ENABLED=true

# PENDING TRANSACTIONS RECONCILER
# RECONCILE_PENDING_TRANSACTIONS_ENABLED: Enable periodic reconciliation of transactions stuck in PENDING balance_status. Values: true|false.
RECONCILE_PENDING_TRANSACTIONS_ENABLED=false
# RECONCILE_PENDING_TRANSACTIONS_PERIOD_MINUTES: Period in minutes between reconciliation runs.
RECONCILE_PENDING_TRANSACTIONS_PERIOD_MINUTES=60

# MIGRATIONS
# MIGRATION_AUTO_RECOVER: Auto-recover failed migrations. Values: true|false.
MIGRATION_AUTO_RECOVER=true
# MIGRATION_MAX_RETRIES: Max retries for migration recovery.
MIGRATION_MAX_RETRIES=3
