BEGIN;

ALTER TABLE transaction
  ALTER COLUMN amount TYPE BIGINT USING amount::BIGINT;

COMMIT;

ALTER TABLE transaction
    ADD COLUMN amount_scale BIGINT NOT NULL DEFAULT 0;