# LEDGER (UNIFIED ONBOARDING + TRANSACTION)
# ENV_NAME: Runtime environment name. Values: development|staging|production.
ENV_NAME=development

# VERSION: Service version string used in logs/telemetry.
VERSION=v3.5.0

# HTTP SERVER (single port for all APIs)
# SERVER_PORT: Port for the unified HTTP API.
SERVER_PORT=3002
# SERVER_ADDRESS: HTTP bind address. Usually :${SERVER_PORT}.
SERVER_ADDRESS=:${SERVER_PORT}

# AUTH (shared)
# PLUGIN_AUTH_ENABLED: Enable auth plugin integration. Values: true|false.
PLUGIN_AUTH_ENABLED=false
# PLUGIN_AUTH_HOST: Auth plugin host (host:port) when enabled.
PLUGIN_AUTH_HOST=

# ACCOUNTING (shared)
# ACCOUNT_TYPE_VALIDATION: Optional list of <organization-id>:<ledger-id> pairs (comma-separated).
ACCOUNT_TYPE_VALIDATION=

# =============================================================================
# ONBOARDING MODULE CONFIGURATION
# =============================================================================

# POSTGRESQL (Onboarding - Primary)
# DB_ONBOARDING_HOST: Primary Postgres host.
DB_ONBOARDING_HOST=midaz-postgres-primary
# DB_ONBOARDING_USER: Primary Postgres user.
DB_ONBOARDING_USER=midaz
# DB_ONBOARDING_NAME: Primary Postgres database name.
DB_ONBOARDING_NAME=onboarding
# DB_ONBOARDING_PASSWORD: Primary Postgres password.
DB_ONBOARDING_PASSWORD=lerian
# DB_ONBOARDING_PORT: Primary Postgres port.
DB_ONBOARDING_PORT=5701
# DB_ONBOARDING_SSLMODE: SSL mode. Values: disable|require.
DB_ONBOARDING_SSLMODE=disable

# POSTGRESQL (Onboarding - Replica)
# DB_ONBOARDING_REPLICA_HOST: Replica Postgres host.
DB_ONBOARDING_REPLICA_HOST=midaz-postgres-replica
# DB_ONBOARDING_REPLICA_USER: Replica Postgres user.
DB_ONBOARDING_REPLICA_USER=midaz
# DB_ONBOARDING_REPLICA_NAME: Replica Postgres database name.
DB_ONBOARDING_REPLICA_NAME=onboarding
# DB_ONBOARDING_REPLICA_PASSWORD: Replica Postgres password.
DB_ONBOARDING_REPLICA_PASSWORD=lerian
# DB_ONBOARDING_REPLICA_PORT: Replica Postgres port.
DB_ONBOARDING_REPLICA_PORT=5702
# DB_ONBOARDING_REPLICA_SSLMODE: Replica SSL mode. Values: disable|require.
DB_ONBOARDING_REPLICA_SSLMODE=disable

# DATABASE POOLING (Onboarding)
# DB_ONBOARDING_MAX_OPEN_CONNS: Max open DB connections.
DB_ONBOARDING_MAX_OPEN_CONNS=3000
# DB_ONBOARDING_MAX_IDLE_CONNS: Max idle DB connections.
DB_ONBOARDING_MAX_IDLE_CONNS=3000

# MONGO (Onboarding)
# MONGO_ONBOARDING_URI: Mongo scheme. Values: mongodb|mongodb+srv.
MONGO_ONBOARDING_URI=mongodb
# MONGO_ONBOARDING_HOST: Mongo host.
MONGO_ONBOARDING_HOST=midaz-mongodb
# MONGO_ONBOARDING_NAME: Mongo database name.
MONGO_ONBOARDING_NAME=onboarding
# MONGO_ONBOARDING_USER: Mongo user.
MONGO_ONBOARDING_USER=midaz
# MONGO_ONBOARDING_PASSWORD: Mongo password.
MONGO_ONBOARDING_PASSWORD=lerian
# MONGO_ONBOARDING_PORT: Mongo port.
MONGO_ONBOARDING_PORT=5703
# MONGO_ONBOARDING_MAX_POOL_SIZE: Mongo connection pool size.
MONGO_ONBOARDING_MAX_POOL_SIZE=1000
# MONGO_ONBOARDING_PARAMETERS: Optional connection parameters.
MONGO_ONBOARDING_PARAMETERS=

# =============================================================================
# TRANSACTION MODULE CONFIGURATION
# =============================================================================

# ACCOUNTING
# TRANSACTION_ROUTE_VALIDATION: Optional list of <organization-id>:<ledger-id> pairs (comma-separated).
TRANSACTION_ROUTE_VALIDATION=

# POSTGRESQL (Transaction - Primary)
# DB_TRANSACTION_HOST: Primary Postgres host.
DB_TRANSACTION_HOST=midaz-postgres-primary
# DB_TRANSACTION_USER: Primary Postgres user.
DB_TRANSACTION_USER=midaz
# DB_TRANSACTION_NAME: Primary Postgres database name.
DB_TRANSACTION_NAME=transaction
# DB_TRANSACTION_PASSWORD: Primary Postgres password.
DB_TRANSACTION_PASSWORD=lerian
# DB_TRANSACTION_PORT: Primary Postgres port.
DB_TRANSACTION_PORT=5701
# DB_TRANSACTION_SSLMODE: SSL mode. Values: disable|require.
DB_TRANSACTION_SSLMODE=disable

# POSTGRESQL (Transaction - Replica)
# DB_TRANSACTION_REPLICA_HOST: Replica Postgres host.
DB_TRANSACTION_REPLICA_HOST=midaz-postgres-replica
# DB_TRANSACTION_REPLICA_USER: Replica Postgres user.
DB_TRANSACTION_REPLICA_USER=midaz
# DB_TRANSACTION_REPLICA_NAME: Replica Postgres database name.
DB_TRANSACTION_REPLICA_NAME=transaction
# DB_TRANSACTION_REPLICA_PASSWORD: Replica Postgres password.
DB_TRANSACTION_REPLICA_PASSWORD=lerian
# DB_TRANSACTION_REPLICA_PORT: Replica Postgres port.
DB_TRANSACTION_REPLICA_PORT=5702
# DB_TRANSACTION_REPLICA_SSLMODE: Replica SSL mode. Values: disable|require.
DB_TRANSACTION_REPLICA_SSLMODE=disable

# DATABASE POOLING (Transaction)
# DB_TRANSACTION_MAX_OPEN_CONNS: Max open DB connections.
DB_TRANSACTION_MAX_OPEN_CONNS=3000
# DB_TRANSACTION_MAX_IDLE_CONNS: Max idle DB connections.
DB_TRANSACTION_MAX_IDLE_CONNS=3000

# MONGO (Transaction)
# MONGO_TRANSACTION_URI: Mongo scheme. Values: mongodb|mongodb+srv.
MONGO_TRANSACTION_URI=mongodb
# MONGO_TRANSACTION_HOST: Mongo host.
MONGO_TRANSACTION_HOST=midaz-mongodb
# MONGO_TRANSACTION_NAME: Mongo database name.
MONGO_TRANSACTION_NAME=transaction
# MONGO_TRANSACTION_USER: Mongo user.
MONGO_TRANSACTION_USER=midaz
# MONGO_TRANSACTION_PASSWORD: Mongo password.
MONGO_TRANSACTION_PASSWORD=lerian
# MONGO_TRANSACTION_PORT: Mongo port.
MONGO_TRANSACTION_PORT=5703
# MONGO_TRANSACTION_MAX_POOL_SIZE: Mongo connection pool size.
MONGO_TRANSACTION_MAX_POOL_SIZE=1000
# MONGO_TRANSACTION_PARAMETERS: Optional connection parameters.
MONGO_TRANSACTION_PARAMETERS=

# =============================================================================
# SHARED CONFIGURATION
# =============================================================================

# REDIS (shared)
# REDIS_HOST: Redis host.
REDIS_HOST=midaz-valkey:5704
# REDIS_MASTER_NAME: Sentinel master name (required when using sentinel).
REDIS_MASTER_NAME=
# REDIS_TLS: Enable TLS for Redis. Values: true|false.
REDIS_TLS=false
# REDIS_CA_CERT: Path to CA cert (required when REDIS_TLS=true).
REDIS_CA_CERT=
# REDIS_USE_GCP_IAM: Use GCP IAM auth. Values: true|false.
REDIS_USE_GCP_IAM=false
# REDIS_SERVICE_ACCOUNT: Service account email for GCP IAM auth.
REDIS_SERVICE_ACCOUNT=
# GOOGLE_APPLICATION_CREDENTIALS: Path to GCP credentials JSON.
GOOGLE_APPLICATION_CREDENTIALS=
# REDIS_TOKEN_LIFETIME: IAM token lifetime in minutes (<= 60).
REDIS_TOKEN_LIFETIME=60
# REDIS_TOKEN_REFRESH_DURATION: IAM token refresh interval in minutes.
REDIS_TOKEN_REFRESH_DURATION=45
# REDIS_PASSWORD: Redis password (leave empty for no auth).
REDIS_PASSWORD=lerian
# REDIS_DB: Redis database index.
REDIS_DB=0
# REDIS_PROTOCOL: Redis protocol version (2 or 3).
REDIS_PROTOCOL=3

# REDIS POOL & RETRY
# REDIS_POOL_SIZE: Max connections in pool.
REDIS_POOL_SIZE=10
# REDIS_MIN_IDLE_CONNS: Minimum idle connections.
REDIS_MIN_IDLE_CONNS=0
# REDIS_READ_TIMEOUT: Read timeout in seconds.
REDIS_READ_TIMEOUT=3
# REDIS_WRITE_TIMEOUT: Write timeout in seconds.
REDIS_WRITE_TIMEOUT=3
# REDIS_DIAL_TIMEOUT: Dial timeout in seconds.
REDIS_DIAL_TIMEOUT=5
# REDIS_POOL_TIMEOUT: Pool wait timeout in seconds.
REDIS_POOL_TIMEOUT=2
# REDIS_MAX_RETRIES: Max retry attempts.
REDIS_MAX_RETRIES=3
# REDIS_MIN_RETRY_BACKOFF: Min backoff in milliseconds.
REDIS_MIN_RETRY_BACKOFF=8
# REDIS_MAX_RETRY_BACKOFF: Max backoff in seconds.
REDIS_MAX_RETRY_BACKOFF=1

# LOGGING
# LOG_LEVEL: Log verbosity. Values: debug|info|warn|error.
LOG_LEVEL=debug

# OPEN TELEMETRY
# OTEL_RESOURCE_SERVICE_NAME: Service name in telemetry.
OTEL_RESOURCE_SERVICE_NAME=ledger
# OTEL_LIBRARY_NAME: Instrumentation library name.
OTEL_LIBRARY_NAME=github.com/LerianStudio/midaz/v3/components/ledger
# OTEL_RESOURCE_SERVICE_VERSION: Service version for telemetry.
OTEL_RESOURCE_SERVICE_VERSION=${VERSION}
# OTEL_RESOURCE_DEPLOYMENT_ENVIRONMENT: Environment label for telemetry.
OTEL_RESOURCE_DEPLOYMENT_ENVIRONMENT=${ENV_NAME}
# OTEL_EXPORTER_OTLP_ENDPOINT_PORT: OTLP exporter port.
OTEL_EXPORTER_OTLP_ENDPOINT_PORT=4317
# OTEL_EXPORTER_OTLP_ENDPOINT: OTLP exporter endpoint.
OTEL_EXPORTER_OTLP_ENDPOINT=midaz-otel-lgtm:${OTEL_EXPORTER_OTLP_ENDPOINT_PORT}
# ENABLE_TELEMETRY: Enable OpenTelemetry. Values: true|false.
ENABLE_TELEMETRY=false

# RABBITMQ (used by transaction module)
# RABBITMQ_URI: RabbitMQ URI scheme (amqp|amqps).
RABBITMQ_URI=amqp
# RABBITMQ_HOST: RabbitMQ host.
RABBITMQ_HOST=midaz-rabbitmq
# RABBITMQ_PORT_HOST: Management/HTTP port (for health checks).
RABBITMQ_PORT_HOST=3003
# RABBITMQ_PORT_AMQP: AMQP port.
RABBITMQ_PORT_AMQP=3004
# RABBITMQ_DEFAULT_USER: Default RabbitMQ user.
RABBITMQ_DEFAULT_USER=transaction
# RABBITMQ_DEFAULT_PASS: Default RabbitMQ password.
RABBITMQ_DEFAULT_PASS=lerian
# RABBITMQ_CONSUMER_USER: Consumer username.
RABBITMQ_CONSUMER_USER=consumer
# RABBITMQ_CONSUMER_PASS: Consumer password.
RABBITMQ_CONSUMER_PASS=lerian
# RABBITMQ_NUMBERS_OF_WORKERS: Number of consumer workers.
RABBITMQ_NUMBERS_OF_WORKERS=5
# RABBITMQ_NUMBERS_OF_PREFETCH: Prefetch count per consumer.
RABBITMQ_NUMBERS_OF_PREFETCH=10
# RABBITMQ_HEALTH_CHECK_URL: RabbitMQ health check URL.
RABBITMQ_HEALTH_CHECK_URL=http://${RABBITMQ_HOST}:${RABBITMQ_PORT_AMQP}
# RABBITMQ_BALANCE_CREATE_QUEUE: Queue for balance creation events.
RABBITMQ_BALANCE_CREATE_QUEUE=transaction.balance_create.queue
# RABBITMQ_TRANSACTION_BALANCE_OPERATION_EXCHANGE: Exchange for balance ops.
RABBITMQ_TRANSACTION_BALANCE_OPERATION_EXCHANGE=transaction.transaction_balance_operation.exchange
# RABBITMQ_TRANSACTION_BALANCE_OPERATION_KEY: Routing key for balance ops.
RABBITMQ_TRANSACTION_BALANCE_OPERATION_KEY=transaction.transaction_balance_operation.key
# RABBITMQ_TRANSACTION_BALANCE_OPERATION_QUEUE: Queue for balance ops.
RABBITMQ_TRANSACTION_BALANCE_OPERATION_QUEUE=transaction.transaction_balance_operation.queue
# RABBITMQ_TRANSACTION_ASYNC: Enable async transaction processing. Values: true|false.
RABBITMQ_TRANSACTION_ASYNC=false

# TRANSACTION EXCHANGE EVENTS
# RABBITMQ_TRANSACTION_EVENTS_ENABLED: Publish transaction events. Values: true|false.
RABBITMQ_TRANSACTION_EVENTS_ENABLED=true
# RABBITMQ_TRANSACTION_EVENTS_EXCHANGE: Exchange for transaction events.
RABBITMQ_TRANSACTION_EVENTS_EXCHANGE=transaction.transaction_events.exchange

# AUDIT LOGGING
# AUDIT_LOG_ENABLED: Enable audit logging. Values: true|false.
AUDIT_LOG_ENABLED=false
# RABBITMQ_AUDIT_EXCHANGE: Exchange for audit logs.
RABBITMQ_AUDIT_EXCHANGE=audit.append_log.exchange
# RABBITMQ_AUDIT_KEY: Routing key for audit logs.
RABBITMQ_AUDIT_KEY=audit.append_log.key

# SWAGGER / OPENAPI
# SWAGGER_TITLE: API title.
SWAGGER_TITLE=Ledger API
# SWAGGER_DESCRIPTION: API description.
SWAGGER_DESCRIPTION=Documentation for the Midaz Ledger API (Unified Onboarding + Transaction)
# SWAGGER_VERSION: API version.
SWAGGER_VERSION=${VERSION}
# SWAGGER_HOST: API host used in docs.
SWAGGER_HOST=${SERVER_ADDRESS}
# SWAGGER_BASE_PATH: Base path for API routes.
SWAGGER_BASE_PATH=/
# SWAGGER_SCHEMES: Allowed schemes (comma-separated). Example: http,https.
SWAGGER_SCHEMES=http
# SWAGGER_LEFT_DELIM: Template left delimiter.
SWAGGER_LEFT_DELIM={{
# SWAGGER_RIGHT_DELIM: Template right delimiter.
SWAGGER_RIGHT_DELIM=}}

# PAGINATION
# MAX_PAGINATION_LIMIT: Max items per page.
MAX_PAGINATION_LIMIT=100
# MAX_PAGINATION_MONTH_DATE_RANGE: Max month span for date range queries.
MAX_PAGINATION_MONTH_DATE_RANGE=3

# BALANCE SYNC WORKER
# BALANCE_SYNC_WORKER_ENABLED: Enable balance sync worker. Values: true|false.
BALANCE_SYNC_WORKER_ENABLED=false
# BALANCE_SYNC_MAX_WORKERS: Max workers for balance sync.
BALANCE_SYNC_MAX_WORKERS=5
